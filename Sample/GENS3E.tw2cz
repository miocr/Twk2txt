 ¼* G E N S 3 E * ÄFul¥ scre¥n editor pro Hisoft as¥embler GENS3M ¾(C) J. Lamaƒ - LECSOFT 4/1986 ùTento ¥editor ¥byl ¥naps†n jako doplnk k as¥embleru ¥GENS3firmy Hisoft. Nechci se nijak dot…kat ¥jmenovan€ ¥firmy, ¥ale ¥vz†jmu objektivity ¥je ¥t„eba ¥konstatovat, ¥e ¥i ¥kdy ¥vlastn‡p„ekladaƒ je nejlep‚‡, jak… na ZX-Spectrum existuje, s ¥editoremGENSu je to ponkud slab‚‡. S editorem, kter… se V†m ¥dostal ¥dorukou, se d† ps†t program podstatn pohodlnji a rychleji. ®Z rozmanit…ch verz‡ GENSu, ¥kter€ ¥mezi ¥spektra„i ¥koluj‡,byla pro realizaci zvolena verze ¥GENS3M, ¥nebo~t ¥podle ¥n†zoruautora je v n‡ nejm€n chyb. ÌEditor je p„ipojen ke GENSu napevno, ƒ‡m vznikl ¥jednolit…blok. V‚echny funkce GENSu v‚ak p„itom zˆstaly zachov†ny. Jedin…rozd‡l je ve v…stupn‡m form†tu na obrazovku, ¥kter… ¥je ¥upravenpro pouit‡ rutiny pro print ¥s ¥form†tem ¥42 ¥znakˆ ¥na ¥„†dce. ¨Editor, stejn jako GENS, je ¥pln ¥relokovateln… ¥po ¥cel€pamti. Mˆeme tedy program pou‡vat ¥v ¥pamti ¥na ¥libovoln…chadres†ch. ßT€m„ v‚echny „‡d‡c‡ kl†vesy editoru jsou zvoleny s ohledemna pou‡v†n‡ kl†vesnice "pluska". Gumov‡ ¥spektristi ¥holt ¥maj‡smˆlu anebo se umaƒkaj‡ (hodn jsou pot„eba shifty). ´Editor je v programu um‡stn pod GENSem, ¥kter… ¥nad ¥sebouvytv†„‡ vlastn‡ programov… buf¥er. Relokaƒn‡ tabulka editoru ¥jepo spu‚tn‡ p„eps†na obrazovkov…m buf¥erem editoru. Pam~t ¥tedyzˆstane maxim†ln vyuita. ÎPo vstupu do editoru a jeho zrelokov†n‡ ¥je ¥posl€ze ¥mon…skok do BASICu, odkud lze ¥se ¥vr†tit ¥zpt ¥do ¥editoru, ¥a ¥tostejnou adresou jako p„i prvn‡m startu. P„i tomto vstupu zˆstanezachov†n i napsan… text (tepl… ¥start). ¥Pozor ¥- ¥nelze ¥pou‡tadres pro studen… a tepl… start GENSu (start + ¥56, ¥resp. ¥61).Editor mimoto vˆbec nem† studen… start. ÁPro p„‡padn€ sl‡dily lze tuto informaci doplnit t‡m, e ¥jetak€ mono spustit samotn… GENS3M, kter… je j†drem ¥programu, ¥ajeho prvn‡ start je na poƒ†teƒn‡ adrese editoru + 4786 (tepl… ¥astuden… start GENSu pak spoƒteme norm†ln). ¥Vlastn‡ ¥GENS3M ¥sesvou relokaƒn‡ tabulkou je dlouh… 9046 ¥bajtˆ, ¥jak ¥je ¥kad€mujist zn†mo. ÿÁSpu‚tn‡ programu: ÿ¶Po p„‡slu‚n€m CLEARu, nahr†n‡ programu ¥(LOAD ¥"GENS3E"CODEna zvolenou adresu, GENS3E je dlouh… 13832 ¥bajtˆ) ¥a ¥pat„iƒn€mRANDOMIZE USR adresa se objev‡ ot†zka "Colours & keyboard ¥clickset¥ing y/n". P„i stisknut‡ kl†vesy "Y" se ¥provede ¥n†sleduj‡c‡‰prava ¥v ¥syst€mov…ch ¥promn¥…ch: ¥(23609):=20, ¦(23561):=20,(23562):=3, (23624):=71, (23693):=71. ¥Jinak ¥se ¥provede ¥prvn‡start GENSu s obvyklou ot†zkou "Buf¥er size" atd. ·P„i ¥pouit‡ ¥GENSov€ho ¥p„‡kazu ¥"B" ¥(Basic) ¥se ¥provedespu‚tn‡ editoru. Pozn†me to podle blikaj‡c‡ho kurzoru ¥v ¥lev€mhorn‡m ¥rohu ¥obrazovky. ¥Nyn‡ ¥mˆeme ¥pou‡vat ¥tchto ¥funkc‡editoru: ÿÅ~R†dkov… editor: ÿ¸Kad… „†dek zobrazen… na obrazovce je i programov…m „†dkem.Nahrajeme-li do editoru program s del‚‡mi ¥„†dky, ¥ne ¥je ¥tchzm‡nn…ch 42, ¥jsou ¥p„ebyteƒn€ ¥znaky ¥ignorov†ny. ¥Pro ¥pohybykurzoru jsou urƒeny norm†ln‡ ¥kl†vesy ¥(‚ipky). ¥Znaky ¥psan€ ¥zkl†vesnice se do ji napsan€ho vpisuj‡, s pat„iƒn…m rozhrnov†n‡mnapsan€ho textu. Jako tabul†tor slou‡ ¥mezera, ¥editor ¥si ¥s†mrozm‡st‡ slova na ¥spr†vn€ ¥pozice. ¥Zaƒ‡n†-li ¥„†dek ¥n†v‚t‡m,zaƒ‡n†me ps†t hned ¥od ¥kraje. ¥Jinak ¥vynech†me ¥alespo ¥jednumezeru. áPouh…m psan‡m ¥textu ¥po ¥obrazovce ¥se ¥vlastn‡ ¥z†pis ¥doprogramu nedje, nastane a p„i stisku kl†vesy ¥"ENTER". ¥Editorpak tento „†dek znovu ¥vyp‡‚e, ¥a ¥to ¥tak, ¥e ¥ji ¥respektujeum‡stn‡ slov na jejich spr†vn€ pozice. To je ¥velice ¥uiteƒn€,protoe to jednak zrychluje ƒin¥ost editoru, jednak p„i n†hodn€mstisknut‡ kl†vesy v m‡st ji napsan€ho programu ¥nemus‡me ¥textopravovat, nebo stiskneme "EXTEND EXTEND" (viz d†le). óV…znam kl†ves v „†dkov€m mŠdu: ÿ¥DELETE ¨.¦ smaz†n‡ znaku p„ed kurzorem, ¸GRAPH ©.¦ smaz†n‡ znaku pod kurzorem, ¹EDIT ª.¦ smaz†n‡ textu od kurzoru do konce „†dku, ¬CAPS ª.¦ zmna mal…ch p‡smen na velk€ a naopak, ®TRUE VIDEO .¦ p„echod na n†sleduj‡c‡ str†nku, µINV VIDEO ¥.¦ p„echod na p„edch†zej‡c‡ str†nku, ³ENTER ©.¦ z†pis „†dku do pamti, ¾EXTEND ¨.¦ „‡d‡c‡ a blokov€ p„‡kazy, ûkrom toho je pozmnn i v…znam nkter…ch dal‚‡ch kl†ves, ¥nap„.S¥ (Symbol Shift) + "Y" nap‡‚e znak "[", nebo S¥ + "I" ¥je ¥znak"" apod. ÿÄ~R‡d‡c‡ a blokov€ p„‡kazy (EXTEND): ûQ ­.¦ smaz†n‡ ¦„†dku §(s §p„em‡stn‡m ¥kurzoru ¥na ²zaƒ†tek „†dku). Neprobhne z†pis smazan€ho ¥„†dku ²do pamti, operace se t…k† jen scre¥n buf¥eru §I ­.¦ zapnut‡/vypnut‡ insertovac‡ho mŠdu, ±DELETE ¨.¦ vypu‚tn‡ „†dku, ÄGRAPH ©.¦ rozhrnut‡ „†dkˆ pro veps†n‡ nov€ho „†dku »doprost„ed ji napsan€ho textu, µTRUE VIDEO .¦ p„echod na posledn‡ str†nku programu, ¯INV VIDEO ¥.¦ p„echod na prvn‡ str†nku programu, ²G ­.¦ skok do editoru GENSu, ¾X ­.¦ skok na studen… start GENSu (clear), °Y ­.¦ n†vrat do BASICu, ÃB ­.¦ oznaƒen‡ zaƒ†tku nebo konce bloku (editor si ¥s†m ²pozn†, co je co), ÃD ­.¦ vypu‚tn‡ bloku ji nadefinovan€ho p„‡kazy "B", ¥M ­.¦ p„esun bloku na m‡sto urƒen‡, ·C ­.¦ zkop‡rov†n‡ bloku. ÿ¬Jestlie p„i ¥blokov€ ¥operaci ¥dojde ¥k ¥p„eplnn‡ ¥pamti(Ramtop uvaovan… editorem je 65¥35), vyp‡‚e se hl†‚ka ¥"Out ¥ofmemory !". P„i nesmysln€m poadavku (nap„. chceme-li ¥zkop‡rovatblok doprost„ed toho ¥sam€ho ¥bloku) ¥se ¥editor ¥ozve ¥"Invalidrequest ¥!". ¥Po ¥vyps†n‡ ¥hl†‚ky ¥b‡ ¥ƒasov† ¥smyƒka ¥(c¥a ¥2sekundy), jej‡ bh lze p„edƒasn ukonƒit stiskem nƒeho. ¯Krom toho ¥je ¥t„eba ¥„‡ci ¥nkolik ¥slov ¥k ¥funkci ¥"B".Oznaƒen‡ bloku se toti nedje zaps†n‡m znaƒky do programu, ¥jakje to obvykl€ (proto tak€ nen‡ oznaƒen‡ ¥bloku §vidt), §aleprovede se tak, e je do pamti uloeno po„ad‡ „†dku od ¥poƒ†tkutextu. Nen‡ tud‡ radno ¥oznaƒit ¥pomoc‡ ¥"B" ¥blok, ¥pak ¥nkdevloit resp. vypustit ¥njak€ ¥„†dky ¥a ¥pot€ ¥prov€st ¥blokovouoperaci. ÿÅDal‚‡ p„‡kazy: ÿµR ­.¦ nadefinov†n‡ stringu pro pozdj‚‡ z†mnu, «N ­.¦ hled†n‡ stringu ji nadefinovan€ho p„‡kazem "F", F ­.¦ hled†n‡ stringu: ÿ®String je hled†n od „†dky s ¥kurzorem ¥do ¥konce ¥programu.Je-li nalezen, vylistuje se program od „†dku s t‡mto stringem ¥ana spodn‡m „†dku se vyp‡‚e "Com¥and :". ÿ¦Nyn‡ mˆeme stisknout: ÿ²F .¦ hled†n‡ n†sleduj‡c‡ho stringu, ¿S .¦ z†mna stringu za string z p„‡kazu "R", ¶cokoli jin€ho zpˆsob‡ n†vrat do hlavn‡ editaƒn‡ smyƒky. ìP„‡kaz "F" (a "N") umouje tak€ hledat cel… p„‡kaz ¥(nap„."LD ¦A,B") a to tak, e mnemoniku od operandˆ od¥l‡me kl†vesou"kurzor ¥doprava" ¥(‚ipka). ¥Zad†me-li ¥v ¥p„‡kazu ¥"F" ¦symboln†sledovan… zm‡nnou kl†vesou, nalezne se tento symbol pouze ¥nam‡st, kde je pouit jako n†v‚t‡ apod. ÁJestlie se string v ¥dan€ ¥oblasti ¥programu ¥nevyskytuje,editor vyp‡‚e hl†‚ku "String absent !". ÿ¦Jak†koli v…‚e neuveden† kl†vesa ¥stisknut† ¥v ¥EXTEND ¥mŠduzpˆsob‡ skok do hlavn‡ editaƒn‡ smyƒky se souƒasn…m vylistov†n‡mstr†nky, kter† byla na obrazovce p„ed stisknut‡m "EXTEND". ¥Tohoje mono vyu‡t v p„‡pad chyby nebo nespr†vn ¥napsan€ho ¥„†dku(pokud je‚t nebyl „†dek odesl†n kl†vesou ENTER). ¥Na ¥obrazovcese toti objev‡ str†nka textu z programov€ho ¥buf¥eru, ¥tj. ¥bezposledn‡ch proveden…ch zmn. ÿ±V GENSu jsou krom toho d†le pozmnny rutiny ¥pro ¥SAVE ¥aLOAD (resp. jsou vol†ny do editoru), take bhem SAVE nebo ¥LOADnedojde k ne†douc‡mu n†vratu do BASICu ¥v ¥p„‡pad ¥BREAKu, ¥jepouze vyps†na hl†‚ka "Inter¥upted" a provede se skok do ¥editoruGENSu. GENS tak€ nehl†s‡ chybu, je-li p„i LOADu nalezen ¥blok ¥snespr†vn…m jm€nem nebo jin…m flag bajtem ¥(jak ¥ten ¥bajt ¥jinaknazvat ?). ŞPosledn‡ pozn†mka se t…k† jen printiv…ch spektr†kˆ. Bedliv‡spektern‡ci ¥ƒtouc‡ ¥pozorn ¥tento ¥manu†l ¥se ¥ji §nesm‡rnpodivuj‡, proƒ ten dement Lamaƒovskej nechal ¥u ¥GENSu ¥je‚t ¥ipˆvodn‡ editor. Je to pr†v kvˆli tisk†rn nebo ƒemusi takov€mu,co ¥snaiv‡ ¥spektr†ln‡ci ¥pou‡vaj‡. ¥Kdy ¥si ¥ov‚em ¦zkus‡tevyprintit kus programu, budete pˆl hodiny hledt, co to ¥z ¥tohokr†mu vlastn ¥leze. ¥Proto ¥p„edes‡l†m ¥d„‡ve ¥ne ¥se ¥zlostn‡spektrouni vraedn vrhnou na svou nebohou ¥tisk†rnu, ¥e ¥chybaNENI v ¥tisk†rn. ¥Takov…m ¥radji ¥porad‡m, ¥aby ¥p„ed ¥tiskemprovedli "POKE start editoru +4837,0: POKE start +651¥,0". Kdybytam snad potom nkdo chtl strkat to, co tam bylo pˆvodn, ¥mˆetam pouknout t„eba 37 a 6, kdy nevymysl‡ nic lep‚‡ho. ²Podrobnj‚‡ informace o tomto ¥pilov€m ¥software ¥je ¥monoz‡skat p„‡mo u toho ‚~tourala, co ¥si ¥mysl‡, ¥e ¥jaktak ¥um‡as¥embler: ûJi„‡ Lamaƒ ml. ÕP„edbo„sk† 8 Ï182 0¥ ¥Praha 8 Ütel. 842424 ûP„edem dkuji za ozn†men€ chyby v editoru, na ¥kter€ ¥mon†zu„iv‡ edit†to„i p„ijdou. O †dn€m programu nelze prohl†sit, ¥eje to posledn‡ verze.