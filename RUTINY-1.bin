 ³*¦ ½*¦ Ã*¦ ©UITENƒ RUTINY ¨*¦ Ã*¦ ½*¦ ÿ¦opsno ze sborn•ku ¥VZ‹ NHKG Ostrava ÇRoz™•˜en• monost• I. ÿŞ1/ ¥P˜epnut• vstupu z obrazovky na tiskrnu a zp”t ôTiskrna §POKE 23743,80 ÊObrazovka ¦POKE 23743,83 ÿ¯P˜•slu™n POKE sm”ruje v™echny vstupy p˜•kazœ PRINT, LIST,PLOT a DRAW na dan kanl. ÿí2/ ¥Vytvo˜en• funkce AD¥R ÿ³funkce AD¥R vrac• pam”šovou adresu ¥prvn•ho ¥datov“ho ¥bytestringu nebo stringov“ho pole. ¥Zm”n•me-li ¥p˜i‘•tac• ¥konstanty4 a 5 na 6 a 7, bude funkce pracovat stejn” jako LEN A$. ğ10¦ DEF FN Z(Z$)=PE¥K(¥PE¥K 23563+256*PE¥K 23564)+4)+256* »PE¥K(¥PE¥K 23563+256*PE¥K 23564)+5) éP˜•klad: ªLET A$="Ahoj" ÖPRINT FN Z(A$) ¨=¥> vrt• pam”šovou adresu, na Ékter“ le• string 'A' ·DIM A$(2,3,4) ÖPRINT FN Z(A$(2,1)¥ §=¥> vrt• pam”šovou adresu ²prvku pole A$(2,1) ÿè3/ ¥Odstran”n• syst“mov“ho hl™en• "Start tape, then pres¥ .¦" èPOKE 23736,187 um•st”n“ p˜ed kad SAVE ÿİ4/ ¥Nastaven• CURSOR m—du ÿ³POKE 23658,0 §L m—d ÎPOKE 23658,8 §C m—d ÎPOKE 23617,1 §E m—d ÎPOKE 23617,2 §G m—d ÿï5/ ¥UTAJEN… PROGRAMU ÿ¸POKE 23570,10 ¦odpoj• klvesu EDIT ÀPOKE 23570,16 ¦zastav• listovn• p˜i stisku ENTER ±POKE 23613,0 §BREAK zhrout• syst“m ÿPOKE 23613,82 ¦odpoj• BREAK rutinu ÀPOKE 23613,84 ¦odpoj• BREAK klvesu (kad“ RUN, CLEAR, GO- ¸SUB, RETURN tuto hodnotu m”n•) õPOKE 23613,0 ×SAVE "Basic prog" CODE 235¥2,lenght ÀGOTO start line ¹uchov Basic jako CODE èPOKE 23659,0 §zavede nulovou edita‘n• z—nu, nen• kam vyp- ¸sat syst“mov“ hl™en• (zhroucen• syst“mu) ªPOKE 23756,0 §vytvo˜• ˜dek s ‘•slem 0 (nelze editovat) ªPOKE 2375¥,10¥ ¥vytvo˜• prvn• ˜dek s ‘•slem 2560¥. ¥Nefun- ¸guje LIST, nelze ud”lat ¥MERGE, ¥pokud ¥byl ¸proveden SAVE "prog" LINE. ÿÚ6/ ¥Funkce RND v intervalu (A,B) .¦ INT(RND*(B-A)+1)+A ì7/ ¥Voln pam”š §.¦ PRINT 65¥36 - USR 7962 ö8/ ¥SCROL¥ obrazovky o jeden ˜dek nahoru .¥ RANDOMIZE USR 3190 ÿÉ9/ ¥Efekt•vn• vyuit• I/O p˜•kazœ ÿ«V p˜•kazech PRINT, LPRINT, LIST, L¥IST A INPUT lze s ¥vho-dou pou•vat prefixu pro nastaven• vstupn•ho portu - #X. Prefixmœe nabvat hodnot 0-3 a ur‘uje zpœsob ¥vstupu ¥informace ¥bezohledu na typ pouit“ instrukce. ÿ­#0, #1 §vstup bude sm”˜ovat do doln•ch 2 ˜dkœ obraz. «#2 «adresuje obrazovku jako standartn• PRINT ±#3 «vstup bude na tiskrn” ıP˜•klad: ª10 FOR I=2 TO 3 Ô20 PRINT #I; "text" Ğ30 NEXT I ÿµProgram vytiskne ˜et”zec "text" nejprve na obrazovce a ¥po-tom na tiskrn” (vsledek by byl stejn i pro LPRINT). ²V p˜•kaze INPUT lze pou•t '#2' pro tisk ˜et”zce ¥na ¥stan-dartn• PRINT pozici, ale vstup informace mus• bt vdy ¥na ¥'#0'nebo '#1'. Zkuste ¥10¦ INPUT #2; "hl™en•"; #0; A$ ÿÕ10/ ¥ˆe™en• soustavy linern•ch rovnic ÿ§FOR K=1 TO N-1 ÕFOR I=K+1 TO N ÕIF ABS A(K,K)<1E-6 THEN PRINT "matice je singulrn•" :STOP ©LET A=A(I,K)/A(K,K) ĞFOR J=K+1 TO N+1 ÓLET A(I,J)=A(I,J)-A(K,J)*A ÉNEXT J: NEXT I: NEXT K ÿ²N - po‘et rovnic ¦A(N,N+1) - roz™•˜en matice koeficientœ ÿÉ1¥/ ¥Determinant matice ÿ¶LET D=1 ÜFOR K=1 TO N ×LET D=D*A(K,K) ÕNEXT K İFOR I=N TO 1 STEP -1 ÏLET A=0 ÜIF I<N THEN FOR J=I+1 TO N: LET A=A+A(I,J)*A(J,N): NEXT J ªLET A(I,N)=(A(I,N)-A)/A(I,I) ÇNEXT I ÿı12/ ¥Vpo‘et inverzn• matice ÿ±FOR L=1 TO N ×LET K=A(L,L): LET A(L,L)=1 ÉFOR I=1 TO N ×IF I=L THEN GOTO 8 ÑIF NOT K THEN GOTO 9 ÏLET C=A(I,L)/K ÕFOR J=1 TO N ×IF J=L THEN GOTO 7 ÑLET A(I,J)=A(I,J)-C*A(L,J) Ç7 NEXT J İLET A(I,L)=-C Ô8 NEXT I Û9 IF NOT K THEN PRINT "matice je singulrn•": STOP ³FOR S=1 TO N ×LET A(L,S)=A(L,S)/K ĞNEXT S İNEXT L ÿı13/ ¥Otev˜en• obrazovky a nastaven• polohy pro vstup znaku íCAL¥ #0D6B ¨(CLS) ÏLD A,2 İCAL¥ #1601 ¨(otev˜en• obrazovky) ÀLD BC,#R¥S¥ §(R¥=˜dek, S¥=sloupec, p˜•kazu AT 0,0 ¥odpo- ¨CAL¥ #0D¥9 ©v•d #1821) ÿè14/ ¥Rezervace pol• (simulace DIM) ÿ«Rutina je provedena pro ¥dvourozm”rn“ ¥pole ¥znakœ. ¥Umon•p˜•stup ze strojov“ho k—du i z Basicu. Z prom”n¥“ ¥VARS ¥z•skmepo‘te‘n• adresu prom”n¥ch. Vyvoln•m CAL¥ #165¥ ¥zarezervujemeprostor pot˜ebn“ d“lky, tj. po‘et*d“lka+8. ¥Do ¥prvn•ch ¥8 ¥byteuvedeme: êByte 1 §ozna‘en• prom”n¥“ (CODE+128) ½Byte 2,3 ¥celkov d“lka (po‘et*d“lka+5) ¼Byte 4 §po‘et dimenz• (2) ÈByte 5,6 ¥po‘et pol• ÏByte 7,8 ¥d“lka pole ÿªZbvaj•c• Byte napln•me mezerami. ¥Posledn• ¥pole ¥napln•mehodnotou 128 do kad“ho Byte. Rutina mus• prob”hnout p˜ed aloka-c• prom”n¥ch v Basicu. ÿ¶ANZA ¦EQU ¥40 ¦(po‘et pol•+1, posledn• pole zapln”no 128) ¨LAEN ¦EQU ¥10¥ ¥(d“lka pol•) ÆVARS ¦EQU ¥23627 ¶LD ¦BC,LAEN ³START ¥LD ¦HL,(VARS) ²LD ¦(HL),C »PUSH HL ¹INC ¥HL ¿LD ¦BC,ANZA*LAEN+8 ­LD ¦(HL),B »CAL¥ #165¥ ¶INC ¥HL ¿POP ¥HL ¹LD ¦(HL),' ' ¹PUSH HL ¹LD ¦D,H ¾LD ¦(HL),193 ³LD ¦E,L ¾INC ¥HL ¹INC ¥DE ¿LD ¦BC,ANZA*LAEN+5 ­LD ¦BC,ANZA*LAEN-1 ³LD ¦(HL),C µLDIR ÂINC ¥HL ¹POP ¥HL ¿LD ¦(HL),B µLD ¦DE,ANZA-1*LAEN+8 ±INC ¥HL ¹AD¥ ¥HL,DE ¼LD ¦(HL),2 µLD ¦BC,LAEN+1 ¸INC ¥HL ³LO¥P1 LD ¦(HL),128 ¹LD ¦BC,ANZA ´INC ¥HL ¿LD ¦(HL),C µDEC ¥BC ¿INC ¥HL ¹LD ¦A,B ¾LD ¦(HL),B µOR ¦C ÀINC ¥HL ¹JR ¦NZ,LO¥P1 ÿÒ15/ ¥Nastaven• barvy INK, PAPER, BORDER ÿ¦INK §EQU ¥7 ÖPAPER ¥EQU ¥0 ºLD ¦A,17 ¶BORDER EQU ¥0 ºRST ¥16 ¸COLOR ¥CAL¥ #0D4D ¶LD ¦A,PAPER ºLD ¦A,16 ·RST ¥16 ¿RST ¥16 ¹CAL¥ #1CAD ¼LD ¦A,INK ¶LD ¦A,BORDER ¹RST ¥16 ¹CAL¥ #2¥9B ¼CAL¥ #1CAD ¶RET ÿÜ16/ ¥Tisk textov“ho ˜et”zce na obrazovce ÿ¥P˜•klad pouit•: ¨LD ¦HL,DATA ×CAL¥ PRINT1 ÑDATA ¦DEFW #1821 §poloha prvn•ho znaku ÁDEFB 6 «po‘et znakœ ÊDEFM "text" ¦text ÑDEFB 13 ªCR (konec ˜dku) ÅDEFB 128 ©znak konce vstupu ïPRINT1 LD ¦B,(HL) ØINC ¥HL ¹INC ¥HL ¿LD ¦C,(HL) µPUSH HL ¿INC ¥HL ¹RST ¥16 ¿PUSH HL ¹POP ¥HL ¿CAL¥ #0D¥9 ¶POP ¥BC ¿POP ¥HL ¹DJNZ PRINT2 »LD ¦B,(HL) µLD ¦A,(HL) »INC ¥HL ¹CP ¦128 ·PRINT2 PUSH BC ¹JR ¦NZ,PRINT1 ¸LD ¦A,(HL) µRET ÿÜ17/ ¥p˜evod des•tkov“ho ‘•sla do HEXA ÿ¨Rutina ‘te t˜• nebo p”tim•stn“ ‘•slo z klvesnice,tiskne jena obrazovce a vsledek ulo• v HEXA do pam”ti na adresu ¥MULT2.Voln• pro p”tim•stn“ ‘•slo je CAL¥ MULTIP, pro ¥t˜•m•stn“ ¥CAL¥ZU10¥. P˜ed voln•m mus•me ¥nastavit ¥tiskovou ¥pozici. ¥Princip¥rce je jednoduch. •sla jsou postupn” ‘tena a v p˜•pad” nenu-lov“ ‘islice je p˜•slu™n faktor ¥p˜i‘ten ¥tolikrt ¥kolik ¥‘in•hodnota ‘•slice. ÿ½MULT ¦DEFW 0 ºCP ¦13 ¸MULT1 ¥DEFB 0 ºRET ¥Z ¹MULT2 ¥DEFW 0 ºCAL¥ MULTIQ ´MULTIP LD ¦HL,10§ ³JR ¦ZU1 ¾LD ¦(MULT),HL ²LD ¦(MULT1),A ¸CAL¥ GET ¸CAL¥ MULTI ¼CP ¦13 ¹LD ¦(MULT2),HL ·RET ¥Z ³ZU1 §CAL¥ GET ¾CAL¥ MULTIQ µCP ¦13 ¿JR ¦Z,ZU10¦ ³RET ¥Z ÀLD ¦(MULT1),A ²PUSH AF ¿CAL¥ ¥ULTI ¶REST 16 ¿LD ¦(MULT2),HL ±POP ¥AF ¸ZU10¦ LD ¦HL,10¦ ´AND ¥%0§1§ ¸LD ¦(MULT),HL ²LD ¦HL,MULT2 ¹CAL¥ GET ¸LD ¦E,A ¾CP ¦13 ¹LD ¦D,0 ¾RET ¥Z ºAD¥ ¥HL,DE ¼CAL¥ MULTIQ µLD ¦A,0 ¾JR ¦Z,ZU10¥ ´LD ¦(MULT1),A ¸LD ¦(MULT1),A ²LD ¦DE,0 ½CAL¥ MULTI ¶LD ¦(MULT),DE ¸LD ¦(MULT2),HL ±LD ¦(MULT2),HL °ZU10¥ ¥LD ¦HL,10¥ µRET ÃLD ¦(MULT),HL «MULTI ¥LD ¦A,(MULTI) ¸CAL¥ GET ¸LD ¦B,A ¾CP ¦13 ¹LD ¦HL,(MULT2) ·RET Z ´MULT3 ¥AD¥ ¥HL,DE ¼CAL¥ MULTIQ µDJNZ MULT3 ¼JR ¦Z,ZU10 µRET ÃLD ¦(MULT1),A «MULTIQ PUSH AF ¿CAL¥ MULTI ¶RST ¥16 ¿LD ¦(MULT2),HL ±POP ¥AF ºZU10 LD ¦HL,10 ¶AND ¥%0§1§ ¸LD ¦(MULT),HL ²CP ¦0 ÀCAL¥ GET ¸RET ÿÜ18/ ¥ten• klvesnice a stringœ ÿ®Rutina ‘te klvesnici, p˜i‘em m”n• n”kter“ znaky na n”mec-k“ p˜ehlsky (a,s,d,f,¥w,e). Program nech ¥v ¥registru ¥A ¥CODEstla‘en“ klvesy. Pro uchovn• znaku je pouit ¥Byte ¥na ¥adrese23728 (pozor p˜i pouit• Beta DISC). ÄRutina INPUT umo–uje ‘•st z klvesnice zadan po‘et znakœ,‘ten• p˜eru™it znakem CR, znaky ulo• p˜•mo do datov“ho ¥pole ¥avyp•™e na obrazovce. Do registru HL dvme adresu m•sta pro ulo-en• znaku, do registru B maximln• po‘et znakœ. øPAUSE ¥EQU ¥#1F3D ¶LD ¦A,124 µGET1 ¦LD ¦BC,50 ¶RET ÃCAL¥ PAUSE ¯GET8 ¦CP ¦205 ¾LD ¦HL,23728 ³JR ¦NZ,GET9 ºLD ¦(HL),' ' ³LD ¦A,125 ¼RES ¥5,(IY+1) ³RET ÃCAL¥ GET2 °GET9 ¦CP ¦19¥ ¾RET ½JR ¦NZ,GET10 ²GET2 ¦CAL¥ GET3 ·LD ¦A,91 ½LD ¦DE,23728 ³RET ÃLD ¦(23728),A «GET10 ¥CP ¦201 ¾LD ¦BC,0 ·JR ¦NZ,GET1¥ ¹CP ¦0 ºLD ¦A,92 ½JR ¦Z,GET1 µRET ÃINC ¥C ³GET1¥ ¥CP ¦20¥ ¾RET ½JR ¦NZ,GET12 ²GET3 ¦LD ¦A,(#5C07) ²LD ¦A,93 ½CP ¦25¥ ¸RET ÃJR ¦NZ,GET4 ­GET12 ¥CP ¦204 ¾LD ¦A,0 ¸RET ¥NZ ¿RET ½LD ¦A,126 µGET4 ¦CAL¥ #028E ¶RET ÃLD ¦C,0 ±INPUT1 PUSH BC ¿JR ¦Z,GET5 µPUSH HL ¿LD ¦A,0 ¸CAL¥ GET ·GET5 ¦CAL¥ #031E ¶CP ¦13 ¿JR ¦C,GET6 µJR ¦Z,INPUT2 ¹LD ¦A,0 ¸POP ¥HL ¸GET6 ¦DEC ¥D ºLD ¦(HL),A »LD ¦E,A ¸RST ¥16 ¿CAL¥ #03¦ ¶POP ¥BC ¿RET ½INC ¥HL ¸GET §CAL¥ GET1 ·DJNZ INPUT1 »CP ¦2¥6 ¸JR ¦INPUT3 »JR ¦NZ,GET7 ­INPUT2 POP ¥BC ¿LD ¦A,123 ¶POP ¥BC ¿RET ¶INPUT3 LD ¦A,13 ¶GET7 ¦CP ¦195 ¸RST ¥16 ¿JR ¦NZ,GET8 ´RET ÿÜ19/ ¥LOAD a SAVE bez nv”™t• ÿ±LOAD «zave’ soubor bez nv”™t• ¿SAVE «ulo soubor bez nv”™t• ÀLOAD-H ©zave’ soubor s nv”™t•m ÀSAVE-H ©ulo soubor s nv”™t•m ÿ¦PLACE ªpo‘te‘n• adresa ÇLENGHT ©d“lka (po‘et Byte) ÅHEADER ©po‘te‘n• adresa nv”™t• ÿForma nv”™t•: ¥Byte 01 ªtyp ¥0 Basic Ü1 islicov“ pole Ó2 znakov“ pole Õ3 CODE ÊByte 02-1¥ §ozna‘en• souboru ÅByte 12-13 §d“lka souboru ÈByte 14-15 §po‘te‘n• adresa ÅByte 16-17 §d“lka programu 